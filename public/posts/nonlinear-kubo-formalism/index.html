<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>ðŸ¥¸Nonlinear Response Theory of the Kubo Formula - OkongOyangO&#39;s Notes</title><meta name="Description" content="OkongOyangO&#39;s Notes on Condensed Matter Physics"><meta property="og:url" content="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/">
  <meta property="og:site_name" content="OkongOyangO&#39;s Notes">
  <meta property="og:title" content="ðŸ¥¸Nonlinear Response Theory of the Kubo Formula">
  <meta property="og:description" content="This article aims to derive the nonlinear response theory of the Kubo Formula.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-07T22:30:00-05:00">
    <meta property="article:modified_time" content="2023-03-07T22:30:00-05:00">
    <meta property="article:tag" content="Nonlinear Response">
    <meta property="article:tag" content="Kubo Formula">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ðŸ¥¸Nonlinear Response Theory of the Kubo Formula">
  <meta name="twitter:description" content="This article aims to derive the nonlinear response theory of the Kubo Formula.">
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/OkongOyangO.Notes/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/OkongOyangO.Notes/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/OkongOyangO.Notes/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/OkongOyangO.Notes/apple-touch-icon.png"><link rel="mask-icon" href="/OkongOyangO.Notes/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/OkongOyangO.Notes/site.webmanifest"><link rel="canonical" href="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" /><link rel="prev" href="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/fermi_golden_rule/" /><link rel="next" href="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/joule_heat/" /><link rel="stylesheet" href="/OkongOyangO.Notes/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "ðŸ¥¸Nonlinear Response Theory of the Kubo Formula",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/OkongOyangO.github.io\/OkongOyangO.Notes\/posts\/nonlinear-kubo-formalism\/"
        },"genre": "posts","keywords": "Nonlinear Response, Kubo Formula","wordcount":  3332 ,
        "url": "https:\/\/OkongOyangO.github.io\/OkongOyangO.Notes\/posts\/nonlinear-kubo-formalism\/","datePublished": "2023-03-07T22:30:00-05:00","dateModified": "2023-03-07T22:30:00-05:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "OkongOyangO"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/OkongOyangO.Notes/" title="OkongOyangO&#39;s Notes">OkongOyangO&#39;s Notes</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item active" href="/OkongOyangO.Notes/posts/" title="Posts"><i class='fas fa-archive fa-fw'></i> Posts </a><a class="menu-item" href="/OkongOyangO.Notes/tags/" title="Tags"><i class='fas fa-tags fa-fw'></i> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search/æœç´¢/æ¤œç´¢..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i> Search
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i> Theme
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i> Language
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" selected>English</option><option value="/OkongOyangO.Notes/zh-cn/posts/nonlinear-kubo-formalism/">ç®€ä½“ä¸­æ–‡</option><option value="/OkongOyangO.Notes/ja/posts/nonlinear-kubo-formalism/">æ—¥æœ¬èªž</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/OkongOyangO.Notes/" title="OkongOyangO&#39;s Notes">OkongOyangO&#39;s Notes</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search/æœç´¢/æ¤œç´¢..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/OkongOyangO.Notes/posts/" title="Posts"><i class='fas fa-archive fa-fw'></i>Posts</a><a class="menu-item" href="/OkongOyangO.Notes/tags/" title="Tags"><i class='fas fa-tags fa-fw'></i>Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>Theme
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>Language
                    <select class="language-select" onchange="location = this.value;"><option value="/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" selected>English</option><option value="/OkongOyangO.Notes/zh-cn/posts/nonlinear-kubo-formalism/">ç®€ä½“ä¸­æ–‡</option><option value="/OkongOyangO.Notes/ja/posts/nonlinear-kubo-formalism/">æ—¥æœ¬èªž</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ðŸ¥¸Nonlinear Response Theory of the Kubo Formula</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/OkongOyangO.Notes/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>OkongOyangO</a></span>&nbsp;<span class="post-category">included in <a href="/OkongOyangO.Notes/categories/physics-notes/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Physics Notes</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-03-07">2023-03-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;3332 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;16 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#density-matrix-in-dirac-picture">Density Matrix in Dirac Picture</a></li>
    <li><a href="#linear-response">Linear Response</a></li>
    <li><a href="#nonlinear-response">Nonlinear Response</a></li>
    <li><a href="#frequency-domain">Frequency Domain</a></li>
    <li><a href="#time-translation-symmetry">Time Translation Symmetry</a>
      <ul>
        <li><a href="#linear-order-susceptibility">Linear Order Susceptibility</a></li>
        <li><a href="#nonlinear-order-susceptibility">Nonlinear Order Susceptibility</a></li>
      </ul>
    </li>
    <li><a href="#kubo-formula-in-momentum-space">Kubo Formula in Momentum Space</a></li>
    <li><a href="#second-harmonic-generation--zero-frequency-term">Second Harmonic Generation &amp; Zero Frequency Term</a></li>
    <li><a href="#kubo-formula-for-fermi-golden-rule">Kubo Formula for Fermi Golden Rule</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>This article aims to derive the nonlinear response theory of the Kubo Formula.</p>
<h2 id="introduction">Introduction</h2>
<p>Both linear and nonlinear response theories of the Kubo Formula are essentially perturbation theories in quantum mechanics.</p>
<p>Linear response is more common; for example, experimentally measured susceptibilities such as conductivity, magnetic susceptibility, and electric polarizability are all linear response functions (Retarded Green Functions).</p>
<p>However, nonlinear response also has its application values, such as second-order current response in semiconductors, including Second Harmonic Generation, Injection and Shift Current, etc.</p>
<p>Second-order response can even be used to explain the two types of responses discussed in the previous section on Fermi Golden Rule: the constant transition rate and the second harmonic transition rate.</p>
<p><a href="https://zhuanlan.zhihu.com/p/611688122" target="_blank" rel="noopener noreffer ">https://zhuanlan.zhihu.com/p/611688122</a></p>
<p>It can be seen that <strong>as long as one is bold enough, nonlinear response is everywhere</strong>.</p>
<h2 id="density-matrix-in-dirac-picture">Density Matrix in Dirac Picture</h2>
<p>The derivation of the Kubo Formula starts from the evolution of the system&rsquo;s density matrix in the interaction (Dirac) picture.</p>
<p>In the section on Fermi Golden Rule, we have already derived the equation of motion for the wave function in the interaction (Dirac) picture.</p>
<p>Simply viewing the density matrix as $\hat{\rho}_D(t) \sim | \psi (t) \rangle_D \langle \psi(t) |_D$ helps us quickly recall the equation of motion for the density matrix in the interaction (Dirac) picture:</p>
$$
\begin{aligned}
\frac{d}{dt} \hat{\rho}_D(t) = - \frac{i}{\hbar} [ \hat{\rho}_D(t) , \hat{V}_D(t) ]
\end{aligned}
$$<p>By integrating and iterating repeatedly, we can obtain the expansion of the density matrix:</p>
$$
\begin{aligned}
\hat{\rho}_D(t) = \hat{\rho}_0 + \sum_{n = 1}^{\infty} (-\frac{\mathrm{i}}{\hbar})^n \int_{-\infty}^{t} dt_1 \int_{-\infty}^{t_1} dt_2 \dots \int_{-\infty}^{t_{n-1}} dt_n [\hat{V}_D(t_1),[\dots[\hat{V}_D(t_n),\hat{\rho}_0]\dots] ]
\end{aligned}
$$<p>Note that the upper limit of each integral is not always $t$.</p>
<h2 id="linear-response">Linear Response</h2>
<p>Consider only the linear response:</p>
$$
\begin{aligned}
\hat{\rho}_D(t)  \approx \hat{\rho}_0 + (-\frac{\mathrm{i}}{\hbar}) \int_{-\infty}^t \mathrm{~d} t^{\prime} \left[\hat{V}_{D}\left(t^{\prime}\right), \hat{\rho}_0 \right]
\end{aligned}
$$<p>where $\hat{\rho}_0$ is the equilibrium density matrix:</p>
$$
\begin{aligned}
\hat{\rho}_0 = \frac{\exp \left(-\beta \mathcal{H}_0\right)}{\operatorname{Tr}[\exp \left(-\beta \mathcal{H}_0\right)]}
\end{aligned}
$$<p>We wish to investigate the time evolution of an observable $\hat{A}$:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_t = \operatorname{Tr}\{ \hat{\rho}_D(t) \hat{A}_D(t) \}
\end{aligned}
$$$$
\begin{aligned}
\langle\hat{A}\rangle_t = \langle\hat{A}\rangle_0 +(-\frac{\mathrm{i}}{\hbar}) \int_{-\infty}^t \mathrm{~d} t^{\prime} \operatorname{Tr}\left\{\left[\hat{V}_{D}\left(t^{\prime}\right), \hat{\rho}_0 \right] \hat{A}_D(t) \right\}
\end{aligned}
$$<p>where,</p>
$$
\begin{aligned}
\langle\dots\rangle_0 = \operatorname{Tr}\{ \hat{\rho}_0 (\dots) \}
\end{aligned}
$$$$
\begin{aligned}
\hat{A}_D(t) = \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right) \hat{A}_S(t)  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right)
\end{aligned}
$$<p>For the following perturbation form:</p>
$$
\begin{aligned}
\hat{V}_S(t) = \hat{B}_S(t) F(t)
\end{aligned}
$$$$
\begin{aligned}
\langle\hat{A}\rangle_t = \langle\hat{A}\rangle_0 +(-\frac{\mathrm{i}}{\hbar}) \int_{-\infty}^t \mathrm{~d} t^{\prime} F(t^{\prime}) \operatorname{Tr}\left\{\left[\hat{B}_{D}\left(t^{\prime}\right), \hat{\rho}_0 \right] \hat{A}_D(t) \right\}
\end{aligned}
$$<p>Using the cyclic property of the Trace, it can be proven that:</p>
$$
\begin{aligned}
\operatorname{Tr}\left\{\left[\hat{B}_{D}\left(t^{\prime}\right), \hat{\rho}_0 \right] \hat{A}_D(t) \right\} = \operatorname{Tr}\left\{\rho_0\left[\hat{A}_D(t), \hat{B}_{D}\left(t^{\prime}\right)\right]\right\}
\end{aligned}
$$<p>Thus:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_t = \langle\widehat{A}\rangle_0 +(-\frac{\mathrm{i}}{\hbar}) \int_{-\infty}^t \mathrm{~d} t^{\prime} F(t^{\prime}) \operatorname{Tr}\left\{\rho_0\left[\hat{A}_D(t), \hat{B}_{D}\left(t^{\prime}\right)\right]\right\}
\end{aligned}
$$<p>In this way, physical quantities in the expression can be written in the form of $\operatorname{Tr}\left\{\rho_0(\dots)\right\}$.</p>
<p>This indicates that the near-equilibrium response can be determined by the observables of the equilibrium state.</p>
<p>Generally, we consider the difference of the observable $\hat{A}$ under perturbation from the equilibrium state, so we can also write the linear response in the following form:</p>
$$
\begin{aligned}
\Delta A_t  =\langle\hat{A}\rangle_t-\langle\widehat{A}\rangle_0=-\frac{\mathrm{i}}{\hbar} \int_{-\infty}^t \mathrm{~d} t^{\prime} F(t^{\prime})\left\langle\left[\widehat{A}^{\mathrm{D}}(t), \widehat{B}^{\mathrm{D}}\left(t^{\prime}\right)\right]_{-}\right\rangle_0
\end{aligned}
$$<p>Or written as:</p>
$$
\begin{aligned}
\Delta A_t =  \int_{-\infty}^{+ \infty} \mathrm{~d} t^{\prime} G_{A B}^{\mathrm{ret}}\left(t; t^{\prime}\right) F(t^{\prime})
\end{aligned}
$$<p>This is the form of the linear response Kubo Formula in the Time Domain.</p>
<p>It contains the retarded Green Function,</p>
$$
\begin{aligned}
G_{A B}^{\mathrm{ret}}\left(t; t^{\prime}\right) = -\frac{\mathrm{i}}{\hbar} \Theta\left(t-t^{\prime}\right)\left\langle\left[\hat{A}_D(t), \hat{B}_D\left(t^{\prime}\right)\right]\right\rangle_0 = -\frac{\mathrm{i}}{\hbar} \Theta\left(t-t^{\prime}\right)\left\langle\left[\hat{A}_H(t), \hat{B}_H\left(t^{\prime}\right)\right]\right\rangle_0
\end{aligned}
$$<p>Here, since we are calculating the properties of the equilibrium state, the subscripts $D, H$ representing the Dirac and Heisenberg Pictures make no difference, which reflects from another aspect that the system&rsquo;s near-equilibrium response is completely determined by the system&rsquo;s equilibrium properties.</p>
<p>The linear response formula given so far is general and does not consider properties like time translation symmetry (when $\hat{A}_S, \hat{B}_S$ do not explicitly contain time $t$). If the retarded Green Function $G_{A B}^{\mathrm{ret}}\left(t; t^{\prime}\right)$ possesses time translation symmetry:</p>
$$
\begin{aligned}
G_{A B}^{\mathrm{ret}}\left(t; t^{\prime}\right) = G_{A B}^{\mathrm{ret}}\left(t -  t^{\prime}\right)
\end{aligned}
$$<p>we can obtain a more concise linear response theory in the Frequency Domain. We will discuss this further after deriving the general second-order response.</p>
<h2 id="nonlinear-response">Nonlinear Response</h2>
<p>Now we want to calculate the nonlinear (higher-order) response. We simply expand the perturbed density matrix to higher orders and repeat the derivation above.</p>
<p>Expanding the perturbed density matrix to higher orders (taking the second-order response as an example),</p>
$$
\begin{aligned}
\hat{\rho}_D(t) & \approx \hat{\rho}_0 + (-\frac{\mathrm{i}}{\hbar}) \int_{-\infty}^t \mathrm{~d} t^{\prime} \left[\hat{V}_{D}\left(t^{\prime}\right), \hat{\rho}_0 \right] \\
& + (-\frac{\mathrm{i}}{\hbar})^2 \int_{-\infty}^t \mathrm{~d} t^{\prime} \int_{-\infty}^{t'} \mathrm{~d} t'' \left[\hat{V}_{D}\left(t^{\prime}\right), \left[\hat{V}_{D}\left(t''\right), \hat{\rho}_0 \right] \right] \\
& + \dots
\end{aligned}
$$<p>Thus the response of the observable $\hat{A}$ is:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_t = \langle\hat{A}\rangle_0 + \langle\hat{A}\rangle_1 + \langle\hat{A}\rangle_2 + \dots
\end{aligned}
$$$$
\begin{aligned}
\langle\hat{A}\rangle_2 & = (-\frac{\mathrm{i}}{\hbar})^2 \int_{-\infty}^t \mathrm{~d} t^{\prime} \int_{-\infty}^{t'} \mathrm{~d} t'' \operatorname{Tr} \{ \left[\hat{V}_{D}\left(t^{\prime}\right), \left[\hat{V}_{D}\left(t''\right), \hat{\rho}_0 \right] \right] \hat{A}_D(t) \}
\end{aligned}
$$<p>Using the cyclic property of the Trace, we have:</p>
$$
\begin{aligned}
\operatorname{Tr} \left\{ \left[\hat{V}_{D}\left(t^{\prime}\right), \left[\hat{V}_{D}\left(t''\right), \hat{\rho}_0 \right] \right] \hat{A}_D(t) \right\} = \operatorname{Tr} \left\{\rho_0\left[ \left[\hat{A}_D(t), \hat{V}_{D}\left(t^{\prime}\right)\right] , \hat{V}_{D}\left(t''\right)\right] \right\}
\end{aligned}
$$<p>Thus:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_2 & = (-\frac{\mathrm{i}}{\hbar})^2 \int_{-\infty}^t \mathrm{~d} t^{\prime} \int_{-\infty}^{t'} \mathrm{~d} t'' \operatorname{Tr} \left\{\rho_0\left[ \left[\hat{A}_D(t), \hat{V}_{D}\left(t^{\prime}\right)\right] , \hat{V}_{D}\left(t''\right)\right] \right\}
\end{aligned}
$$<p>In fact, there is a more general conclusion:</p>
$$
\begin{aligned}
\operatorname{Tr} \left\{ \left[\hat{V}_{D}\left(t_1\right), \dots ,\left[\hat{V}_{D}\left(t_n\right), \hat{\rho}_0 \right] \dots \right] \hat{A}_D(t) \right\} = \operatorname{Tr} \left\{\rho_0\left[ \dots\left[\hat{A}_D(t), \hat{V}_{D}\left(t_1\right)\right], \dots , \hat{V}_{D}\left(t_n\right)\right]\right\}
\end{aligned}
$$<p>We can calculate the response of any order:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_n & = (-\frac{\mathrm{i}}{\hbar})^2 \int_{-\infty}^t \mathrm{~d} t_1 \int_{-\infty}^{t_1} \mathrm{~d} t_2 \dots \int_{-\infty}^{t_{n-1}} \mathrm{~d} t_n \operatorname{Tr} \left\{\rho_0\left[ \dots\left[\hat{A}_D(t), \hat{V}_{D}\left(t_1\right)\right], \dots , \hat{V}_{D}\left(t_n\right)\right]\right\}
\end{aligned}
$$<p>Repeating the previous operation, if the perturbation can be separated into an external field (not necessarily a scalar field) and an operator part:</p>
$$
\begin{aligned}
\hat{V}_S(t) = \hat{B}^\mu_S(t) F_\mu(t)
\end{aligned}
$$<p>Then the second-order response can be written as,</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_2 & = (-\frac{\mathrm{i}}{\hbar})^2 \int_{-\infty}^t \mathrm{~d} t^{\prime} \int_{-\infty}^{t'} \mathrm{~d} t'' \operatorname{Tr} \left\{\rho_0\left[ \left[\hat{A}_D(t), \hat{B}^\mu_{D}\left(t^{\prime}\right)\right] , \hat{B}^\nu_{D}\left(t''\right)\right] \right\} F_\mu(t')F_\nu(t'') \\
& = \int_{-\infty}^{+ \infty} \mathrm{~d} t^{\prime} \int_{-\infty}^{+\infty} \mathrm{~d} t'' \chi_2^{\mu\nu}(t;t',t'') F_\mu(t')F_\nu(t'')
\end{aligned}
$$<p>where $\chi_2^{\mu\nu}(t;t',t'')$ is the second-order susceptibility, defined as:</p>
$$
\begin{aligned}
\chi_2^{\mu\nu}(t;t',t'') \equiv (-\frac{\mathrm{i}}{\hbar})^2 \Theta(t - t') \Theta(t' - t'') \operatorname{Tr} \left\{\rho_0\left[ \left[\hat{A}_D(t), \hat{B}^\mu_{D}\left(t^{\prime}\right)\right] , \hat{B}^\nu_{D}\left(t''\right)\right] \right\}
\end{aligned}
$$<p>This can be generalized to any order of response:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_n & = (-\frac{\mathrm{i}}{\hbar})^2 \int_{-\infty}^t \mathrm{~d} t_1 \int_{-\infty}^{t_1} \mathrm{~d} t_2 \dots \int_{-\infty}^{t_{n-1}} \mathrm{~d} t_n \operatorname{Tr} \left\{\rho_0\left[ \dots\left[\hat{A}_D(t), \hat{B}^{\mu_1}_{D}\left(t_1\right)\right], \dots , \hat{B}^{\mu_n}_{D}\left(t_n\right)\right]\right\} F_{\mu_1}(t_1) \dots F_{\mu_n}(t_n) \\
& = \int_{-\infty}^{+ \infty} \mathrm{~d} t_1 \dots \int_{-\infty}^{+\infty} \mathrm{~d} t_n  \chi_n^{\mu_1 \dots \mu_n}(t;t_1,\dots,t_n)  F_{\mu_1}(t_1) \dots F_{\mu_n}(t_n)
\end{aligned}
$$<h2 id="frequency-domain">Frequency Domain</h2>
<p>First, without considering whether the system has time translation symmetry, we switch from Time Domain to Frequency Domain by simply performing a Fourier Transformation on all time parameters.</p>
$$
\begin{aligned}
\chi_n(t;t_1,\dots,t_n) \xLeftrightarrow{F.T.} \chi_n(\omega ;\omega_1,\dots,\omega_n)
\end{aligned}
$$<p>The advantage of doing this is that general external fields are single-frequency, such as monochromatic electromagnetic waves. The Kubo Formula in the Frequency Domain can directly tell us the frequency and amplitude of the response. However, essentially it is still a Fourier Transformation.</p>
<p>Specifically:</p>
$$
\begin{aligned}
\chi_n(\omega ;\omega_1,\dots,\omega_n) \equiv \int_{- \infty}^{+ \infty} \mathrm{~d} t e^{-i\omega t} \int_{- \infty}^{+ \infty} \mathrm{~d} t_1 e^{-i\omega_1 t_1} \dots \int_{- \infty}^{+ \infty} \mathrm{~d} t_n e^{-i\omega_n t_n} \chi_n(t;t_1,\dots,t_n)
\end{aligned}
$$$$
\begin{aligned}
\chi_n(t;t_1,\dots,t_n) = \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega}{2 \pi} e^{i\omega t} \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_1}{2 \pi} e^{i\omega_1 t_1} \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_n}{2\pi} e^{i\omega_n t_n} \chi_n(\omega ;\omega_1,\dots,\omega_n)
\end{aligned}
$$<p>Similarly, Fourier Transform the observable and the external field to frequency space,</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_n(\omega) = \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega}{2 \pi} e^{i\omega t} \langle\hat{A}\rangle_n(t)
\end{aligned}
$$$$
\begin{aligned}
F(\omega_i) = \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_i}{2 \pi} e^{i\omega_i t_i} F(t_i)
\end{aligned}
$$<p>Thus, the Kubo Formula in the Frequency Domain is:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_n(\bar{\omega}) & = \int_{- \infty}^{+ \infty} \mathrm{~d} t  e^{-i \bar{\omega} t} \langle\hat{A}\rangle_n(t) \\
& = \int_{- \infty}^{+ \infty} \mathrm{~d} t  e^{-i \bar{\omega} t}  \int_{-\infty}^{+ \infty} \mathrm{~d} t_1 \dots \int_{-\infty}^{+\infty} \mathrm{~d} t_n  \\
& \times \chi_n^{\mu_1 \dots \mu_n}(t;t_1,\dots,t_n)  F_{\mu_1}(t_1) \dots F_{\mu_n}(t_n)
\end{aligned}
$$$$
\begin{aligned}
& = \int_{- \infty}^{+ \infty} \mathrm{~d} t  e^{-i \bar{\omega} t}  \int_{-\infty}^{+ \infty} \mathrm{~d} t_1 \dots \int_{-\infty}^{+\infty} \mathrm{~d} t_n \\
& \times \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega}{2 \pi} e^{i\omega t} \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_1}{2 \pi} e^{i\omega_1 t_1} \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_n}{2\pi} e^{i\omega_n t_n} \\
& \times  \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \bar{\omega}_1}{2 \pi} e^{i\bar{\omega}_1 t_1} \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \bar{\omega}_n}{2\pi} e^{i\bar{\omega}_n t_n}\\
& \times \chi_n^{\mu_1 \dots \mu_n}(\omega ;\omega_1,\dots,\omega_n) F_{\mu_1}(\bar{\omega}_1) \dots F_{\mu_n}(\bar{\omega}_n)
\end{aligned}
$$$$
\begin{aligned}
& =  \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega}{2 \pi} \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_1}{2 \pi}  \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_n}{2\pi}  \\
& \times  \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \bar{\omega}}{2 \pi}  \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \bar{\omega}_1}{2 \pi}  \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \bar{\omega}_n}{2\pi} \\
& \times \int_{- \infty}^{+ \infty} \mathrm{~d} t  e^{i (\omega - \bar{\omega}) t} \int_{-\infty}^{+ \infty} \mathrm{~d} t_1 e^{i (\omega_1 + \bar{\omega}_1) t_1}\dots \int_{-\infty}^{+\infty} \mathrm{~d} t_n e^{i (\omega_n + \bar{\omega}_n) t_n} \\
& \times \chi_n^{\mu_1 \dots \mu_n}(\omega ;\omega_1,\dots,\omega_n) F_{\mu_1}(\bar{\omega}_1) \dots F_{\mu_n}(\bar{\omega}_n)
\end{aligned}
$$$$
\begin{aligned}
& = \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega}{2 \pi} \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_1}{2 \pi}  \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_n}{2\pi}  \\
& \times  \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \bar{\omega}}{2 \pi}  \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \bar{\omega}_1}{2 \pi}  \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \bar{\omega}_n}{2\pi} \\
& \times 2 \pi \delta(\bar{\omega} - \omega) \times 2 \pi \delta (\omega_1 + \bar{\omega}_1) \times \dots \times 2 \pi \delta (\omega_n + \bar{\omega}_n) \\
& \times \chi_n^{\mu_1 \dots \mu_n}(\omega ;\omega_1,\dots,\omega_n) F_{\mu_1}(\bar{\omega}_1) \dots F_{\mu_n}(\bar{\omega}_n)
\end{aligned}
$$<p>Finally, the Kubo Formula in the Frequency Domain is:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_n(\bar{\omega}) & =  \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_1}{2 \pi}  \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_n}{2\pi}  \chi_n^{\mu_1 \dots \mu_n}(\bar{\omega} ;\omega_1,\dots,\omega_n) F_{\mu_1}(-\omega_1) \dots F_{\mu_n}(-\omega_n)
\end{aligned}
$$<p>The negative sign here can also be removed by redefining the Fourier Transformation of the parameters $\{t;t_1,\dots,t_n\}$.</p>
<p>For example, performing different Fourier Transformations on the left and right sides of &ldquo;;&rdquo;:</p>
$$
\begin{aligned}
\chi_n(\omega ;\omega_1,\dots,\omega_n) \equiv \int_{- \infty}^{+ \infty} \mathrm{~d} t e^{-i\omega t} \int_{- \infty}^{+ \infty} \mathrm{~d} t_1 e^{i\omega_1 t_1} \dots \int_{- \infty}^{+ \infty} \mathrm{~d} t_n e^{i\omega_n t_n} \chi_n(t;t_1,\dots,t_n)
\end{aligned}
$$$$
\begin{aligned}
\chi_n(t;t_1,\dots,t_n) = \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega}{2 \pi} e^{i\omega t} \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_1}{2 \pi} e^{-i\omega_1 t_1} \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_n}{2\pi} e^{-i\omega_n t_n} \chi_n(\omega ;\omega_1,\dots,\omega_n)
\end{aligned}
$$<p>Then we have:</p>
$$
\begin{aligned}
\langle\hat{A}\rangle_n(\bar{\omega}) & =  \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_1}{2 \pi}  \dots \int_{- \infty}^{+ \infty} \frac{\mathrm{~d} \omega_n}{2\pi}  \chi_n^{\mu_1 \dots \mu_n}(\bar{\omega} ;\omega_1,\dots,\omega_n) F_{\mu_1}(\omega_1) \dots F_{\mu_n}(\omega_n)
\end{aligned}
$$<p>But in fact, positive and negative frequency perturbations always exist simultaneously, so the above discussion is just a matter of definition.</p>
<p><strong>To avoid &ldquo;-&rdquo; signs in the Kubo Formula as much as possible, we will adopt the latter definition in the subsequent discussions.</strong></p>
<p>The general case derived here places no restrictions on the relationship between $\{\bar{\omega} ;\omega_1,\dots,\omega_n\}$, meaning a perturbation at any frequency could potentially excite a response at another frequency.</p>
<p>But for a time-translation invariant response function, there will be certain restrictions on the form of the response function in the Frequency Domain.</p>
<p>Taking the most common linear response as an example, the frequency of the response must be the same as the frequency of the external field, i.e.,</p>
$$
\begin{aligned}
\chi_1(\omega; \omega_1) \sim \delta(\omega \pm \omega_1)
\end{aligned}
$$<p>And for more general nonlinear responses, it can be proven that the frequency of the response is the sum of the external field frequencies, i.e.,</p>
$$
\begin{aligned}
\chi_n(\omega; \omega_1,\dots,\omega_n) \sim \delta(\omega \pm \sum_{i=1}^n \omega_i)
\end{aligned}
$$<p>where the &ldquo;$\pm$&rdquo; sign depends on the definition of the response function in the Frequency Domain.</p>
<h2 id="time-translation-symmetry">Time Translation Symmetry</h2>
<p>When the response function possesses time translation symmetry, it can be proven that the response function has the following properties:</p>
$$
\begin{aligned}
\chi_1(t;t') \equiv G_{A B}^{\mathrm{ret}}\left(t; t^{\prime}\right) = G_{A B}^{\mathrm{ret}}\left(t -  t^{\prime}\right)
\end{aligned}
$$$$
\begin{aligned}
\chi_2(t;t',t'') = \chi_2^{\mathcal{T}} (t-t',t'-t'')
\end{aligned}
$$$$
\begin{aligned}
\chi_n(t;t_1,\dots,t_n) = \chi_n^{\mathcal{T}}(t-t_1,t_1-t_2,\dots,t_{n-1} - t_n)
\end{aligned}
$$<p>This is because time translation symmetry ensures that the response function remains unchanged when all times are shifted by the same amount, i.e.,</p>
$$
\begin{aligned}
\chi_n(t;t_1,\dots,t_n) = \chi_n(t + \tau;t_1+ \tau,\dots,t_n+ \tau)
\end{aligned}
$$<p>Thus, among the parameters $\{t;t_1,\dots,t_n\}$, only their relative values are independent. We can define:</p>
$$
\begin{aligned}
& \chi_n^{\mathcal{T}}(t-t_1,t_1-t_2,\dots,t_{n-1} - t_n) \\
& = \chi_n(t_n + \sum_{i=1}^{n-1}(t_{i} - t_{i+1}) + (t - t_1) ;t_n + \sum_{i=1}^{n-1}(t_{i} - t_{i+1}),\dots,t_n + (t_{n-1} - t_n),t_n) \\
& = \chi_n(\sum_{i=1}^{n-1}(t_{i} - t_{i+1}) + (t - t_1) ; \sum_{i=1}^{n-1}(t_{i} - t_{i+1}),\dots, (t_{n-1} - t_n),0)
\end{aligned}
$$<p>Now consider the physical meaning of the response function having time translation symmetry. This actually means that the system and the observables $\hat{A}, \hat{B}$ involved in the response are all time-translation invariant, but this has different meanings in different pictures.</p>
<p>Taking the Schrodinger Picture we are most familiar with as an example, operators not explicitly containing time is sufficient:</p>
$$
\begin{aligned}
\hat{A}_S(t) = \hat{A},\,\hat{B}_S(t) = \hat{B}
\end{aligned}
$$<p>But in the Dirac/Heisenberg Picture, it manifests as:</p>
$$
\begin{aligned}
\hat{A}_H(t) = \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right) \hat{A}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right),\,\hat{B}_H(t) = \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right) \hat{B}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right)
\end{aligned}
$$<p>It can be proven that &ldquo;the response function has time translation symmetry&rdquo; and &ldquo;the system and the observables $\hat{A}, \hat{B}$ involved in the response are all time-translation invariant&rdquo; refer to the same thing. Taking the first-order response function as an example:</p>
$$
\begin{aligned}
G_{A B}^{\mathrm{ret}}\left(t; t^{\prime}\right) & = -\frac{\mathrm{i}}{\hbar} \Theta\left(t-t^{\prime}\right)  \operatorname{Tr} \left\{ \hat{\rho}_0\left[\hat{A}_H(t), \hat{B}_H\left(t^{\prime}\right)\right]\right\}
\end{aligned}
$$<p>Using the cyclic property of the Trace:</p>
$$
\begin{aligned}
& \operatorname{Tr} \left\{ \hat{\rho}_0\left[\hat{A}_H(t), \hat{B}_H\left(t^{\prime}\right)\right]\right\} \\
& = \operatorname{Tr} \left\{ \hat{\rho}_0\left[ \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right) \hat{A}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right) ,  \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t'\right) \hat{B}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t'\right) \right]\right\} \\
& = \operatorname{Tr} \left\{ \hat{\rho}_0\left( \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right) \hat{A}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 (t - t')\right)  \hat{B}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t'\right) - \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t'\right) \hat{B}  \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 (t - t')\right)  \hat{A}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t\right) \right) \right\} \\
& = \operatorname{Tr} \left\{ \hat{\rho}_0\left( \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 (t - t') \right) \hat{A}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 (t - t')\right)  \hat{B}  -  \hat{B}  \exp \left(\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 (t - t')\right)  \hat{A}  \exp \left(-\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 (t-t')\right) \right) \right\} \\
& = \operatorname{Tr} \left\{ \hat{\rho}_0\left( \hat{A}_H(t-t')  \hat{B}  -  \hat{B} \hat{A}_H(t-t') \right) \right\} \\
& = \operatorname{Tr} \left\{ \hat{\rho}_0\left[ \hat{A}_H(t-t') , \hat{B} \right] \right\}
\end{aligned}
$$<p>Thus $\chi_1(t;t') \equiv G_{A B}^{\mathrm{ret}}\left(t; t^{\prime}\right)$ only explicitly contains $(t-t')$.</p>
<p>The derivation utilizes the property that $\hat{\rho}_0 = \frac{\exp \left(-\beta \mathcal{H}_0\right)}{\operatorname{Tr}[\exp \left(-\beta \mathcal{H}_0\right)]}$ commutes with the time evolution operator $\exp \left(\pm\frac{\mathrm{i}}{\hbar} \mathcal{H}_0 t \right)$, because both are functions of $\mathcal{H}_0$.</p>
<p>Similarly, it can be proven that:</p>
<p>When the system and the observables $\hat{A}, \hat{B}$ involved in the response have time translation invariance, the response function of any order possesses time translation symmetry. This is equivalent to the response function being writable in the form $\chi_n(t;t_1,\dots,t_n) = \chi_n^{\mathcal{T}}(t-t_1,t_1-t_2,\dots,t_{n-1} - t_n)$.</p>
<h3 id="linear-order-susceptibility">Linear Order Susceptibility</h3>
<p>Now let&rsquo;s prove that time translation invariance implies that the frequency of the response must be the same as the frequency of the external field, i.e.,</p>
$$
\begin{aligned}
\chi_1(\omega; \omega_1) \sim \delta(\omega - \omega_1)
\end{aligned}
$$<p>Time translation symmetry requires:</p>
$$
\begin{aligned}
\chi_1(t;t_1) = \chi_1^{\mathcal{T}}(t - t_1)
\end{aligned}
$$<p>Thus the linear response function in the Frequency Domain is:</p>
$$
\begin{aligned}
\chi_1(\omega ;\omega_1) & \equiv \int_{- \infty}^{+ \infty} \mathrm{~d} t e^{-i\omega t} \int_{- \infty}^{+ \infty} \mathrm{~d} t_1 e^{i\omega_1 t_1}  \chi_1(t; t_1) \\
& = \int_{- \infty}^{+ \infty} \mathrm{~d} t_1 e^{i(\omega_1 - \omega) t_1} \int_{- \infty}^{+ \infty} \mathrm{~d} (t - t_1) e^{-i\omega (t - t_1)}   \chi_1^{\mathcal{T}}(t - t_1) \\
& = 2 \pi \delta(\omega - \omega_1) \tilde{\chi}_1^{\mathcal{T}}(\omega) \\
& \sim \delta(\omega - \omega_1)
\end{aligned}
$$<p>where $\tilde{\chi}_1^{\mathcal{T}}(\omega)$ is the Fourier Transformation of ${\chi}_1^{\mathcal{T}}(t - t_1)$:</p>
$$
\begin{aligned}
\tilde{\chi}_1^{\mathcal{T}}(\omega) \equiv \int_{- \infty}^{+ \infty} \mathrm{~d} \tau e^{-i\omega \tau}   \chi_1^{\mathcal{T}}(\tau)
\end{aligned}
$$<h3 id="nonlinear-order-susceptibility">Nonlinear Order Susceptibility</h3>
<p>For more general nonlinear responses, it can be proven that the frequency of the response is the sum of the external field frequencies, i.e.,</p>
$$
\begin{aligned}
\chi_n(\omega; \omega_1,\dots,\omega_n) \sim \delta(\omega - \sum_{i=1}^n \omega_i)
\end{aligned}
$$<p>Time translation symmetry requires (note here everything is written as difference from $t_n$):</p>
$$
\begin{aligned}
\chi_n(t;t_1,\dots,t_n) = \chi_n^{\mathcal{T}}(t-t_n,t_1-t_n,\dots,t_{n-1} - t_n)
\end{aligned}
$$<p>Thus the response function in Frequency Domain is:</p>
$$
\begin{aligned}
\chi_n(\omega ;\omega_1,\dots,\omega_n) & \equiv \int_{- \infty}^{+ \infty} \mathrm{~d} t e^{-i\omega t} \int_{- \infty}^{+ \infty} \mathrm{~d} t_1 e^{i\omega_1 t_1} ... \int_{- \infty}^{+ \infty} \mathrm{~d} t_n e^{i\omega_n t_n}  \chi_n(t; t_1,\dots,t_n) \\
& = \int_{- \infty}^{+ \infty} \mathrm{~d} t_n e^{-i(\omega - \sum_{i=1}^n \omega_i) t_n} \int_{- \infty}^{+ \infty} \mathrm{~d} (t - t_n) e^{-i\omega (t - t_n)} \int_{- \infty}^{+ \infty} \mathrm{~d} (t_1 - t_n) e^{i\omega_1 (t_1 - t_n)} \dots \int_{- \infty}^{+ \infty} \mathrm{~d} (t_{n-1} - t_n) e^{i\omega_{n-1} (t_{n-1} - t_n)}  \chi_n^{\mathcal{T}}(t - t_n,\dots,t_{n-1} - t_n) \\
& = 2 \pi \delta(\omega - \sum_{i=1}^n \omega_i) \tilde{\chi}_n^{\mathcal{T}}(\omega,\omega_1,\dots,\omega_{n-1}) \\
& \sim \delta(\omega - \sum_{i=1}^n \omega_i)
\end{aligned}
$$<p>where $\tilde{\chi}_n^{\mathcal{T}}(\omega,\omega_1,\dots,\omega_{n-1})$ is the Fourier Transformation of $\chi_n^{\mathcal{T}}(t - t_n,\dots,t_{n-1} - t_n)$:</p>
$$
\begin{aligned}
\tilde{\chi}_n^{\mathcal{T}}(\omega,\omega_1,\dots,\omega_{n-1}) \equiv \int_{- \infty}^{+ \infty} \mathrm{~d} \tau e^{-i\omega \tau} \int_{- \infty}^{+ \infty} \mathrm{~d} \tau_1 e^{i\omega_1 \tau_1} \dots \int_{- \infty}^{+ \infty} \mathrm{~d} \tau_{n-1} e^{i\omega_{n-1} \tau_{n-1}}  \chi_n^{\mathcal{T}}(\tau,\dots,\tau_{n-1})
\end{aligned}
$$<p>In summary, with the general Kubo Formula for second-order response, we can easily (not really) generalize the various linear responses considered before to nonlinear responses, such as calculating nonlinear conductivity, nonlinear magnetic susceptibility, nonlinear electric polarizability, etc.</p>
<h2 id="kubo-formula-in-momentum-space">Kubo Formula in Momentum Space</h2>
<p>For continuous media (continuous space translation symmetry) or crystals (discrete space translation symmetry), textbooks often also give the Kubo Formula in momentum space.</p>
<p>But this is essentially just performing a Fourier Transform on another parameterâ€”coordinatesâ€”essentially no different from the Fourier Transform between Time Domain and Frequency Domain. Even without space translation symmetry, one can transform every coordinate parameter to obtain the most general form.</p>
<p>One can imagine that, similar to the response function of a system with time translation symmetry, the response function of a system with space translation symmetry will also satisfy a similar (quasi-) momentum conservation form, i.e.:</p>
$$
\begin{aligned}
\chi_n(k; k_1,\dots,k_n) \sim \delta(k - \sum_{i=1}^n k_i)
\end{aligned}
$$<h2 id="second-harmonic-generation--zero-frequency-term">Second Harmonic Generation &amp; Zero Frequency Term</h2>
<p>Next, consider a common time-dependent perturbation, a harmonic perturbation with frequency $\omega_0 > 0$:</p>
$$
\begin{aligned}
\hat{V}_S (t) = \hat{H'} e^{-i\omega_0 t} + \hat{H'}^\dagger e^{i\omega_0 t}
\end{aligned}
$$<p>It can be seen that the external field contributes at frequencies $\pm \omega_0$. For a system with time translation invariance, its first-order response should also only have terms with frequencies $\pm \omega_0$.</p>
<p>As for the second-order response:</p>
$$
\begin{aligned}
\langle \mathcal{O} \rangle_2(\omega) \sim \int d \omega_1 \int d \omega_2 \chi_2(\omega; \omega_1, \omega_2) F(\omega_1) F(\omega_2)
\end{aligned}
$$<p>If the system has time translation symmetry:</p>
$$
\begin{aligned}
\langle \mathcal{O} \rangle_2(\omega) \sim \int d \omega_1 \int d \omega_2 \delta(\omega- \omega_1-\omega_2) F(\omega_1) F(\omega_2)
\end{aligned}
$$<p>And the spectrum of the external field is:</p>
$$
\begin{aligned}
F(\omega) \sim \delta(\omega \pm \omega_0)
\end{aligned}
$$<p>Thus the second-order response can have a second harmonic response, the so-called &ldquo;2nd Harmonic Generation&rdquo;:</p>
$$
\begin{aligned}
\langle \mathcal{O} \rangle_2(\omega) \sim \int d \omega_1 \int d \omega_2 \delta(\omega- \omega_1-\omega_2) \delta(\omega_1 \pm \omega_0) \delta(\omega_2 \pm \omega_0) \sim \delta(\omega \pm 2\omega_0)
\end{aligned}
$$<p>It can also have a Zero Frequency Response, i.e.:</p>
$$
\begin{aligned}
\langle \mathcal{O} \rangle_2(\omega) \sim \int d \omega_1 \int d \omega_2 \delta(\omega- \omega_1-\omega_2) \delta(\omega_1 \pm \omega_0) \delta(\omega_2 \mp \omega_0) \sim \delta(\omega)
\end{aligned}
$$<p>Whether it is Second Harmonic Generation or Zero Frequency Response, they are interesting topics in the nonlinear electro-optical response of semiconductors in condensed matter physics.</p>
<h2 id="kubo-formula-for-fermi-golden-rule">Kubo Formula for Fermi Golden Rule</h2>
<p>In fact, the transition rate (probability) of a quantum system under light excitation can also be viewed as a response of the system to external perturbations.</p>
<p>At this time, the observable of the system is the final state projection operator, the unperturbed density matrix is the initial state projection operator, and the external field is the time-harmonic electromagnetic field of the light wave:</p>
$$
\begin{aligned}
\hat{\mathcal{O}} = | f \rangle \langle f |
\end{aligned}
$$$$
\begin{aligned}
\hat{\rho}_0 = |i \rangle \langle i |
\end{aligned}
$$<p>The transition rate is:</p>
$$
\begin{aligned}
\mathcal{I}_{i \rightarrow f} = \frac{d}{dt} \langle \hat{\mathcal{O}} \rangle
\end{aligned}
$$<p>We skip the derivation details for now and look directly at the second-order response of the system (it can be proven that the first-order response is 0), which will also have the second harmonic response corresponding to Second Harmonic Generation and the Zero Frequency Response.</p>
<p>The latter corresponds to the constant transition rate calculated by the general Fermi Golden Rule, while the former is the second harmonic response omitted in the Fermi Golden Rule mentioned in our previous section. Under the long-time average approximation, it completely corresponds to the result of the Fermi Golden Rule.</p>
<p>Therefore, the Fermi Golden Rule is essentially a second-order response, which can be calculated using the Nonlinear Order Kubo Formula.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-03-07</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" data-title="ðŸ¥¸Nonlinear Response Theory of the Kubo Formula" data-hashtags="Nonlinear Response,Kubo Formula"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Threads" data-sharer="threads" data-url="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" data-title="ðŸ¥¸Nonlinear Response Theory of the Kubo Formula"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" data-hashtag="Nonlinear Response"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" data-title="ðŸ¥¸Nonlinear Response Theory of the Kubo Formula"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" data-title="ðŸ¥¸Nonlinear Response Theory of the Kubo Formula"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@15.14.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on å¾®åš" data-sharer="weibo" data-url="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" data-title="ðŸ¥¸Nonlinear Response Theory of the Kubo Formula"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Diaspora" data-sharer="diaspora" data-url="https://OkongOyangO.github.io/OkongOyangO.Notes/posts/nonlinear-kubo-formalism/" data-title="ðŸ¥¸Nonlinear Response Theory of the Kubo Formula" data-description=""><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=https%3a%2f%2fOkongOyangO.github.io%2fOkongOyangO.Notes%2fposts%2fnonlinear-kubo-formalism%2f&amp;text=%f0%9f%a5%b8Nonlinear%20Response%20Theory%20of%20the%20Kubo%20Formula" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/OkongOyangO.Notes/tags/nonlinear-response/">Nonlinear Response</a>,&nbsp;<a href="/OkongOyangO.Notes/tags/kubo-formula/">Kubo Formula</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/OkongOyangO.Notes/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/OkongOyangO.Notes/posts/fermi_golden_rule/" class="prev" rel="prev" title="ðŸ˜¯What did Fermi Golden Rule Miss?"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>ðŸ˜¯What did Fermi Golden Rule Miss?</a>
            <a href="/OkongOyangO.Notes/posts/joule_heat/" class="next" rel="next" title="ðŸ”¥Fermi Golden Rule? Just Joule Heat!">ðŸ”¥Fermi Golden Rule? Just Joule Heat!<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.154.3">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2024 - 2026</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/OkongOyangO.Notes/" target="_blank">OkongOyangO</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.2/sharer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/mhchem.min.js"></script><script>window.config={"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/OkongOyangO.Notes/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script src="/OkongOyangO.Notes/js/theme.min.js"></script></body>
</html>
